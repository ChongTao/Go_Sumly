# 一 Go数组底层原理

Go 中的 **数组（array）** 是一种**值类型**，**并且长度是类型的一部分**， 例如

```go
var a [3]int
var b [4]int
```

> a和b是两种不同的类型。

## 1.1 Go数组底层数据结构

在 Go 编译器内部，数组的底层其实就是一段**连续内存**，并且类型大致可以理解为：

```go
type Array struct {
    elemType *Type   // 元素类型
    length   int     // 数组长度（固定）
    data     pointer // 指向连续内存区域
}
```

数组本身不是一个Struct，而是编译器在栈或堆上直接开辟一块连续内存，如：

```go
a := [3]int{1, 2, 3}
```

在内存中的地址 |1|2|3|。

## 1.2 Go的数组是值类型

数组被赋值时，Go 会把数组全部复制一份，例如

```go
a := [3]int{1, 2, 3}
b := a
b[0] = 0
```

> 底层给b分配与a一样大的连续内存，将a的3个元素全部复制过去，b的修改不会影响a。注意数组作为参数传递也会整体拷贝



## 1.3 Go的数组存放

数组是存放栈/堆上，取决于数组大小，小数组存放在栈上；大数组会被编译器自动逃逸到堆上。

